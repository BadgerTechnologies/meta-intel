From ad3e325c1af4d6533fd9b3dfc5208267b678327a Mon Sep 17 00:00:00 2001
From: Naveen Saini <naveen.kumar.saini@intel.com>
Date: Thu, 6 Feb 2020 18:25:19 +0800
Subject: [PATCH] don't use LD_LIBRARY_PATH for native offline compiler

Let us supply the correct path for it to be able to find the correct
libraries.

Upstream-Status: Inappropriate

Signed-off-by: Anuj Mittal <anuj.mittal@intel.com>
Signed-off-by: Naveen Saini <naveen.kumar.saini@intel.com>
---
 runtime/built_ins/kernels/CMakeLists.txt | 2 +-
 runtime/scheduler/scheduler_binary.cmake | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/runtime/built_ins/kernels/CMakeLists.txt b/runtime/built_ins/kernels/CMakeLists.txt
index 863dba145..a385cf768 100644
--- a/runtime/built_ins/kernels/CMakeLists.txt
+++ b/runtime/built_ins/kernels/CMakeLists.txt
@@ -66,7 +66,7 @@ function(compile_builtin gen_type platform_type builtin bits builtin_options)
     if(DEFINED NEO__IGC_LIBRARY_PATH)
       set(cloc_cmd_prefix LD_LIBRARY_PATH=${NEO__IGC_LIBRARY_PATH} $<TARGET_FILE:ocloc>)
     else()
-      set(cloc_cmd_prefix LD_LIBRARY_PATH=$<TARGET_FILE_DIR:ocloc> $<TARGET_FILE:ocloc>)
+      set(cloc_cmd_prefix ocloc)
     endif()
   endif()
   list(APPEND __cloc__options__ "-cl-kernel-arg-info")
diff --git a/runtime/scheduler/scheduler_binary.cmake b/runtime/scheduler/scheduler_binary.cmake
index a7015b909..a720d2f5c 100644
--- a/runtime/scheduler/scheduler_binary.cmake
+++ b/runtime/scheduler/scheduler_binary.cmake
@@ -37,7 +37,7 @@ function(compile_kernel target gen_type platform_type kernel)
     if(DEFINED NEO__IGC_LIBRARY_PATH)
       set(cloc_cmd_prefix LD_LIBRARY_PATH=${NEO__IGC_LIBRARY_PATH} $<TARGET_FILE:ocloc>)
     else()
-      set(cloc_cmd_prefix LD_LIBRARY_PATH=$<TARGET_FILE_DIR:ocloc> $<TARGET_FILE:ocloc>)
+      set(cloc_cmd_prefix ocloc)
     endif()
   endif()
   list(APPEND __cloc__options__ "-cl-kernel-arg-info")
-- 
2.17.1

